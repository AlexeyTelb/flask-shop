<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">–ú–æ–π –º–∞–≥–∞–∑–∏–Ω</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('products') }}">–¢–æ–≤–∞—Ä—ã</a>
                    </li>
                    {% if is_admin %}
                    <li class="nav-item">
                        <a class="nav-link " href="{{ url_for('add_product') }}">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
                    </li>
                    {% endif %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('basket') }}">–ö–æ—Ä–∑–∏–Ω–∞</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('orders') }}">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">–í—ã–π—Ç–∏</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="btn btn-outline-primary" href="{{ url_for('client_page') }}">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>-->
    {% extends "base.html" %}
    {% block content %}
    <div class="container mt-4">
        <h2>üõçÔ∏è –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</h2>

        <!-- –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ -->
        <input type="text" id="searchBox" class="form-control mb-3" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º...">

        <!-- –ö–Ω–æ–ø–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
        <div class="mb-3">
            <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
            <select id="sortSelect" class="form-select">
                <option value="default">–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
                <option value="price_asc">–¶–µ–Ω–∞: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                <option value="price_desc">–¶–µ–Ω–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
                <option value="name_asc">–ù–∞–∑–≤–∞–Ω–∏–µ: –æ—Ç –ê –¥–æ –Ø</option>
                <option value="name_desc">–ù–∞–∑–≤–∞–Ω–∏–µ: –æ—Ç –Ø –¥–æ –ê</option>
            </select>
        </div>

        <!-- –í—ã–≤–æ–¥ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div class="row" id="productList">
            {% for product in products %}
            <div class="col-md-3 mb-4 product-card"
                 data-name="{{ product.productname.lower() }}"
                 data-price="{{ product.price }}">
                <div class="card h-100 shadow-sm">
                    <img src="{{ product.photo }}" class="card-img-top" alt="{{ product.productname }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ product.productname }}</h5>
                        <p class="card-text"><strong>–¶–µ–Ω–∞:</strong> {{ product.price }} ‚ÇΩ</p>
                        <a href="{{ url_for('product_detail', product_id=product.productid) }}" class="btn btn-primary">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
    // –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)
    document.getElementById("searchBox").addEventListener("input", function() {
        let searchValue = this.value.toLowerCase();
        let products = document.querySelectorAll(".product-card");

        products.forEach(product => {
            let name = product.getAttribute("data-name");
            if (name.includes(searchValue)) {
                product.style.display = "block";
            } else {
                product.style.display = "none";
            }
        });
    });

    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)
    document.getElementById("sortSelect").addEventListener("change", function() {
        let sortValue = this.value;
        let productList = document.getElementById("productList");
        let products = Array.from(document.querySelectorAll(".product-card"));

        if (sortValue === "price_asc") {
            products.sort((a, b) => a.dataset.price - b.dataset.price);
        } else if (sortValue === "price_desc") {
            products.sort((a, b) => b.dataset.price - a.dataset.price);
        } else if (sortValue === "name_asc") {
            products.sort((a, b) => a.dataset.name.localeCompare(b.dataset.name));
        } else if (sortValue === "name_desc") {
            products.sort((a, b) => b.dataset.name.localeCompare(a.dataset.name));
        }

        // –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ DOM
        products.forEach(product => productList.appendChild(product));
    });
    </script>
    {% endblock %}
</body>
</html>
